diff -Naur xorg-server-1.17.1/glamor/Makefile.am xorg-server-1.17.1.tpg/glamor/Makefile.am
--- xorg-server-1.17.1/glamor/Makefile.am	2014-11-21 03:02:48.000000000 +0000
+++ xorg-server-1.17.1.tpg/glamor/Makefile.am	2015-02-21 00:11:30.671390249 +0000
@@ -1,6 +1,7 @@
 noinst_LTLIBRARIES = libglamor.la libglamor_egl_stubs.la
 
-libglamor_la_LIBADD = $(GLAMOR_LIBS)
+libglamor_la_LDFLAGS = -module -avoid-version $(LD_NO_UNDEFINED_FLAG)
+libglamor_la_LIBADD = $(GLAMOR_LIBS) $(DLOPEN_LIBS)
 
 AM_CFLAGS = $(CWARNFLAGS) $(DIX_CFLAGS) $(GLAMOR_CFLAGS)
 
diff -Naur xorg-server-1.17.1/hw/xfree86/drivers/modesetting/Makefile.am xorg-server-1.17.1.tpg/hw/xfree86/drivers/modesetting/Makefile.am
--- xorg-server-1.17.1/hw/xfree86/drivers/modesetting/Makefile.am	2015-01-17 23:42:52.000000000 +0000
+++ xorg-server-1.17.1.tpg/hw/xfree86/drivers/modesetting/Makefile.am	2015-02-21 00:12:58.280717455 +0000
@@ -24,7 +24,7 @@
 # _ladir passes a dummy rpath to libtool so the thing will actually link
 # TODO: -nostdlib/-Bstatic/-lgcc platform magic, not installing the .a, etc.
 
-AM_CFLAGS = $(DIX_CFLAGS) $(XORG_CFLAGS) $(LIBDRM_CFLAGS) $(UDEV_CFLAGS) $(CWARNFLAGS)
+AM_CFLAGS = $(DIX_CFLAGS) $(XORG_CFLAGS) $(LIBDRM_CFLAGS) $(UDEV_CFLAGS) $(CWARNFLAGS) $(GLAMOR_CFLAGS)
 
 AM_CPPFLAGS = \
 	$(XORG_INCS) \
@@ -39,7 +39,7 @@
 
 modesetting_drv_la_LTLIBRARIES = modesetting_drv.la
 modesetting_drv_la_LDFLAGS = -module -avoid-version
-modesetting_drv_la_LIBADD = $(UDEV_LIBS) $(DRM_LIBS)
+modesetting_drv_la_LIBADD = $(UDEV_LIBS) $(DRM_LIBS) $(FB_LIB) $(FIXES_LIB) $(MI_LIB) $(XEXT_LIB) $(DAMAGE_LIB) $(PRESENT_LIB) $(MIEXT_SYNC_LIB) $(MIEXT_DAMAGE_LIB) $(MIEXT_SHADOW_LIB) $(XI_LIB) $(XKB_LIB) $(XKB_STUB_LIB) $(COMPOSITE_LIB) $(DIX_LIB) $(OS_LIB) $(GLAMOR_LIBS) $(top_builddir)/glamor/libglamor.la $(top_builddir)/glamor/libglamor_egl_stubs.la $(DLOPEN_LIBS)
 modesetting_drv_ladir = @moduledir@/drivers
 
 modesetting_drv_la_SOURCES = \
