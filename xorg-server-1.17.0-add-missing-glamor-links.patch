diff -Naur xorg-server-1.17.1/glamor/Makefile.am xorg-server-1.17.1.tpg/glamor/Makefile.am
--- xorg-server-1.17.1/glamor/Makefile.am	2014-11-21 03:02:48.000000000 +0000
+++ xorg-server-1.17.1.tpg/glamor/Makefile.am	2015-02-14 08:24:16.146447617 +0000
@@ -1,6 +1,6 @@
 noinst_LTLIBRARIES = libglamor.la libglamor_egl_stubs.la
-
-libglamor_la_LIBADD = $(GLAMOR_LIBS)
+libglamor_la_LDFLAGS = -module -avoid-version $(LD_NO_UNDEFINED_FLAG)
+libglamor_la_LIBADD = $(GLAMOR_LIBS) $(DLOPEN_LIBS)
 
 AM_CFLAGS = $(CWARNFLAGS) $(DIX_CFLAGS) $(GLAMOR_CFLAGS)
 
diff -Naur xorg-server-1.17.1/glamor/Makefile.in xorg-server-1.17.1.tpg/glamor/Makefile.in
--- xorg-server-1.17.1/glamor/Makefile.in	2015-02-10 22:50:00.000000000 +0000
+++ xorg-server-1.17.1.tpg/glamor/Makefile.in	2015-02-14 08:25:59.516196191 +0000
@@ -557,7 +557,8 @@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 noinst_LTLIBRARIES = libglamor.la libglamor_egl_stubs.la
-libglamor_la_LIBADD = $(GLAMOR_LIBS)
+libglamor_la_LDFLAGS = -module -avoid-version $(LD_NO_UNDEFINED_FLAG)
+libglamor_la_LIBADD = $(GLAMOR_LIBS) $(DLOPEN_LIBS)
 AM_CFLAGS = $(CWARNFLAGS) $(DIX_CFLAGS) $(GLAMOR_CFLAGS)
 libglamor_la_SOURCES = \
 	glamor.c \
diff -Naur xorg-server-1.17.1/hw/xfree86/drivers/modesetting/Makefile.am xorg-server-1.17.1.tpg/hw/xfree86/drivers/modesetting/Makefile.am
--- xorg-server-1.17.1/hw/xfree86/drivers/modesetting/Makefile.am	2015-01-17 23:42:52.000000000 +0000
+++ xorg-server-1.17.1.tpg/hw/xfree86/drivers/modesetting/Makefile.am	2015-02-14 08:13:12.346391588 +0000
@@ -24,7 +24,7 @@
 # _ladir passes a dummy rpath to libtool so the thing will actually link
 # TODO: -nostdlib/-Bstatic/-lgcc platform magic, not installing the .a, etc.
 
-AM_CFLAGS = $(DIX_CFLAGS) $(XORG_CFLAGS) $(LIBDRM_CFLAGS) $(UDEV_CFLAGS) $(CWARNFLAGS)
+AM_CFLAGS = $(DIX_CFLAGS) $(XORG_CFLAGS) $(LIBDRM_CFLAGS) $(UDEV_CFLAGS) $(CWARNFLAGS) $(GLAMOR_CFLAGS)
 
 AM_CPPFLAGS = \
 	$(XORG_INCS) \
@@ -39,7 +39,7 @@
 
 modesetting_drv_la_LTLIBRARIES = modesetting_drv.la
 modesetting_drv_la_LDFLAGS = -module -avoid-version
-modesetting_drv_la_LIBADD = $(UDEV_LIBS) $(DRM_LIBS)
+modesetting_drv_la_LIBADD = $(UDEV_LIBS) $(DRM_LIBS) $(GLAMOR_LIBS) $(top_builddir)/glamor/libglamor.la $(top_builddir)/glamor/libglamor_egl_stubs.la
 modesetting_drv_ladir = @moduledir@/drivers
 
 modesetting_drv_la_SOURCES = \
diff -Naur xorg-server-1.17.1/hw/xfree86/drivers/modesetting/Makefile.in xorg-server-1.17.1.tpg/hw/xfree86/drivers/modesetting/Makefile.in
--- xorg-server-1.17.1/hw/xfree86/drivers/modesetting/Makefile.in	2015-02-10 22:50:02.000000000 +0000
+++ xorg-server-1.17.1.tpg/hw/xfree86/drivers/modesetting/Makefile.in	2015-02-14 08:13:12.348391642 +0000
@@ -574,7 +574,7 @@
 top_build_prefix = @top_build_prefix@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
-AM_CFLAGS = $(DIX_CFLAGS) $(XORG_CFLAGS) $(LIBDRM_CFLAGS) $(UDEV_CFLAGS) $(CWARNFLAGS)
+AM_CFLAGS = $(DIX_CFLAGS) $(XORG_CFLAGS) $(LIBDRM_CFLAGS) $(UDEV_CFLAGS) $(CWARNFLAGS) $(GLAMOR_CFLAGS)
 AM_CPPFLAGS = \
 	$(XORG_INCS) \
 	-I$(top_srcdir)/glamor \
@@ -588,7 +588,7 @@
 
 modesetting_drv_la_LTLIBRARIES = modesetting_drv.la
 modesetting_drv_la_LDFLAGS = -module -avoid-version
-modesetting_drv_la_LIBADD = $(UDEV_LIBS) $(DRM_LIBS)
+modesetting_drv_la_LIBADD = $(UDEV_LIBS) $(DRM_LIBS) $(GLAMOR_LIBS) $(top_builddir)/glamor/libglamor.la $(top_builddir)/glamor/libglamor_egl_stubs.la
 modesetting_drv_ladir = @moduledir@/drivers
 modesetting_drv_la_SOURCES = \
 	 dri2.c \
